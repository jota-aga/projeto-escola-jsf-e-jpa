<!DOCTYPE html >
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:p="http://primefaces.org/ui"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	template="/WEB-INF/template/layout.xhtml">

	<f:metadata>
		<f:viewAction action="#{chartBean.procuraTodosCursos}" />
	</f:metadata>
	<ui:define name="head">

		<script type="text/javascript"
			src="https://www.gstatic.com/charts/loader.js"></script>
		<script type="text/javascript">
	      google.charts.load('current', {'packages':['corechart']});
	      google.charts.setOnLoadCallback(drawChart);
	
	      function drawChart() {
	
	        var data = google.visualization.arrayToDataTable([
	          ['Cursos', 'Maior quantidade de alunos'],
	          ["Ciência da Computação",  #{chartBean.pegarPorPosicao(0).alunos.size()}],
	          ["Engenharia Elétrica",  #{chartBean.pegarPorPosicao(1).alunos.size()}],
	          ["Letras",  #{chartBean.pegarPorPosicao(2).alunos.size()}],
	          ["Direito",  #{chartBean.pegarPorPosicao(3).alunos.size()}]
	        ]);
	
	        var options = {
	          title: 'Quantidade de alunos por Curso'
	        };
	
	        var chart = new google.visualization.PieChart(document.getElementById('piechart'));
	
	        chart.draw(data, options);
	      }	    
	    </script>
		<script type="text/javascript">
    google.charts.load("current", {packages:["corechart"]});
    google.charts.setOnLoadCallback(drawChart);
    function drawChart() {
      var data = google.visualization.arrayToDataTable([
        ["Curso", "Professores", { role: "style" } ],
        ["Ciência da Computação", #{chartBean.pegarPorPosicao(0).professores.size()}, "green"],
        ["Engenharia Elétrica", #{chartBean.pegarPorPosicao(1).professores.size()}, "yellow"],
        ["Letras", #{chartBean.pegarPorPosicao(2).professores.size()}, "silver"],
        ["Direito", #{chartBean.pegarPorPosicao(3).professores.size()}, "red"]
      ]);

      var view = new google.visualization.DataView(data);
      view.setColumns([0, 1,
                       { calc: "stringify",
                         sourceColumn: 1,
                         type: "string",
                         role: "annotation" },
                       2]);

      var options = {
        title: "Quantidade de Professores Por Curso",
        width: 600,
        height: 400,
        bar: {groupWidth: "95%"},
        legend: { position: "none" },
      };
      var chart = new google.visualization.BarChart(document.getElementById("barchart_values"));
      chart.draw(view, options);
  		}
  	</script>
	</ui:define>
	<ui:define name="titulo">#{key.inicio}</ui:define>

	<ui:define name="titulo-cabecalho">#{key.inicio}</ui:define>


	<ui:define name="conteudo">
		<div id="graficos" style="display: flex; align-content: center">
			<div id="piechart" style="width: 900px; height: 500px;"></div>
			<div id="barchart_values" style="width: 900px; height: 300px;"></div>
		</div>
		<h:form style="text-align:center; margin:0 auto 0 auto">
			<h2>#{key.mediaPorCurso}</h2>
			<div style="display: flex; justify-content:center">
				<p:panelGrid columns="2">
					<p:outputLabel for="curso" value="#{key.curso}"/>
					<p:selectOneMenu id="curso" value="#{chartBean.cursoSelecionado}" converter="#{chartBean.cursoConverter}">
					<f:selectItem itemLabel="#{key.selecione}"/>
						<f:selectItems value="#{chartBean.todosCursos}" var="curso" itemLabel="#{curso.nome}" itemValue="#{curso}"/>
					</p:selectOneMenu>
					<p:outputLabel for="media" value="#{key.media}"/>
					<h:outputText id="media" value="#{chartBean.media}"/>
				</p:panelGrid>
			</div>
			<h:commandButton value="#{key.media}" actionListener="#{chartBean.consumirServico()}" style="margin-top: 5px"/>
		</h:form>
	</ui:define>

</ui:composition>